# PWAキーボード表示問題 対応手順書

## 問題の概要
新ドメイン（ranking.bungu-squad.com）のPWAをホーム画面に追加した際、ログイン画面でキーボードが表示されない問題が発生。

## 根本原因
1. **旧ドメインのPWA残存**
   - ranking.bungu-squad.jp のPWA/Service Workerが残っている
   - 新旧のService Workerが競合している可能性

2. **iOS Safari PWAの既知のバグ**
   - iOS 15以降で報告されているPWAのフォーカス問題
   - 特に初回インストール直後に発生しやすい

## 対応手順

### ステップ1: 旧PWAの完全削除
1. **ホーム画面から旧アプリ（.jp）を削除**
   - アイコンを長押し → ✕ボタンで削除

2. **Safari のキャッシュクリア**
   - 設定 → Safari → 履歴とWebサイトデータを消去

3. **端末の再起動**（重要）
   - 電源ボタン長押し → スライドで電源オフ
   - 30秒待ってから再起動

### ステップ2: 新PWAのインストール
1. **Safari で新URL にアクセス**
   - https://ranking.bungu-squad.com

2. **ホーム画面に追加**
   - 共有ボタン → ホーム画面に追加

3. **初回起動時の注意**
   - アプリを開いたら10秒程度待つ
   - 入力欄を2回タップしてみる
   - それでもキーボードが出ない場合は、一度アプリを閉じて再度開く

### ステップ3: それでも解決しない場合
1. **ログイン画面の「キャッシュクリア」ボタンを使用**
   - 「初めての方はこちら」の下にあるボタン

2. **再度端末を再起動**

3. **デバイス情報の収集**（サポート依頼用）
   - iOSバージョン
   - 端末モデル（iPhone 13等）
   - 再現手順の動画

## 予防策
- PWAを新規インストールする際は、必ず旧バージョンを完全削除してから行う
- ドメイン変更時は、旧ドメインのService Workerを無効化する処理を入れる（今後実装予定）

## 技術的な注意事項
- 過度なフォーカス制御は副作用（キーボードが閉じられない等）を引き起こすため避ける
- iOS特有の問題のため、Androidでは発生しない可能性が高い

## 連絡先
問題が解決しない場合は、以下の情報と共にご連絡ください：
- デバイス情報（iOS バージョン、機種）
- 再現手順の詳細
- 可能であれば画面録画

---
作成日: 2025-09-23
作成者: 菊池健司（ちーけん）