# 大会ライフサイクル概要（2025-07-27）

## 大会の完全なフロー

### 1. エントリーフェーズ ✅ 実装済み
```
QRコード読み取り
  ↓
未登録者 → 新規登録画面 → メールアドレス・ニックネーム入力
  ↓
ログイン
  ↓
大会エントリー
  ↓
tournament_active = true
  ↓
待機画面へ自動遷移
```

### 2. 組み合わせフェーズ 🔄 未実装
```
管理者：組み合わせ決定ボタン
  ↓
対戦方式選択（ランダム/相性考慮/手動）
  ↓
組み合わせ生成
  ↓
参加者：待機画面で組み合わせ確認
  ↓
対戦相手・テーブル番号表示
```

### 3. 対戦フェーズ 🔄 未実装
```
指定テーブルへ移動
  ↓
ゲーム開始ボタン
  ↓
対戦実施
  ↓
結果入力（勝ち/負けボタン）
  ↓
承認待ち状態へ
```

### 4. 承認フェーズ 🔄 未実装
```
管理者に承認待ち通知
  ↓
管理者：結果確認・承認
  ↓
レーティング計算（自動）
  ↓
ポイント更新
  ↓
ランキング即時反映
```

### 5. アーカイブフェーズ ✅ 一部実装済み
```
日付変更（0時）
  ↓
Vercel Cron Job実行
  ↓
TournamentDailyArchiveへ保存
  ↓
tournament_active全リセット
  ↓
大会ステータス：開催中→過去へ
```

## 実装状況サマリー

### ✅ 完了済み機能
1. QRコードエントリーシステム
2. ログイン・新規登録フロー
3. 待機画面（TournamentWaiting）
4. tournament_activeフラグ管理
5. 日次自動リセット（Cron Job）
6. アーカイブ機能（API実装済み）

### 🔄 次の実装優先順位

#### 1. 組み合わせ決定機能（最優先）
- 管理者用組み合わせ画面
- 対戦方式選択UI
- 組み合わせアルゴリズム
- 参加者への通知システム

#### 2. 対戦結果入力システム
- 対戦画面UI
- 勝敗入力インターフェース
- 結果の一時保存

#### 3. 承認システム
- 管理者承認画面
- 承認待ちキュー
- レーティング計算統合

#### 4. 履歴機能
- プレイヤー個人履歴
- 大会アーカイブ閲覧

## 技術的課題と解決策

### データ構造の拡張が必要
- Matchesシート：対戦記録
- TournamentDailyArchiveシート：日次保存
- 組み合わせ状態管理

### リアルタイム性の確保
- 組み合わせ通知
- 承認待ち通知
- 結果反映

### ハイブリッド管理方式
- 自動進行＋管理者介入
- エラー時の手動操作
- 柔軟な大会運営