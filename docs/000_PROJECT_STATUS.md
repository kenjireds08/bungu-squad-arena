# 000_PROJECT_STATUS.md - BUNGU SQUAD Arena 重要事項管理

## 🎯 プロジェクト状態（最終更新: 2025-09-13）

### 現在のステータス
- **稼働状況**: 本番運用中 ✅
- **URL**: https://ranking.bungu-squad.jp
- **最新デプロイ**: 2025年9月（試合編集・レーティング計算バグ修正）
- **データベース**: Google Sheets API（ゼロコスト運用）
- **ホスティング**: Vercel（無料プラン → 商用時Pro移行）

### 直近の修正履歴
1. **試合編集時のレーティング計算バグ修正** (4372308)
2. **レーティング表示の不整合修正** (69a5b39)
3. **PWAキーボード表示問題修正** (281e420)
4. **完了試合編集時の重複作成バグ修正** (666e1ca)
5. **試合編集・無効化機能の緊急修正** (df17350)

---

## 📌 今後の開発TODO（2025-09-13 更新）

### 🔴 緊急度：高（即対応必要）

#### 1. ✅ 大会参加履歴に大会名を表示【完了済み】
- **実装日**: 2025-09-13
- **改善内容**: 日付の代わりに大会名（例：BUNGU夏合宿2025、文具戦仁伝 サコ応援杯）を表示
- **対象画面**: プレイヤー画面 → 大会参加履歴
- **状態**: ✅ 実装完了・本番反映済み

#### 2. 試合開始・勝敗確定の反応速度改善
- **現状**: 1分程度かかることがある（ワラビサコさんから指摘）
- **改善**: 即座に反映されるよう高速化
- **以前修正済みだが再発している可能性**

### 🟡 緊急度：中（次回大会までに）

#### 3. 組み合わせ生成のバランス改善
- **課題1**: ランダム組み合わせで特定プレイヤーが偏る（10試合中1-2回しか出ない等）
- **課題2**: 同じプレイヤーが連続出場してしまう
- **改善案**:
  - 出場回数の均等化アルゴリズム
  - 連続出場回避ロジック

#### 4. 大規模大会対応（10人以上）
- **課題**: 総当たりが時間的に困難
- **要望**: 参加者を半分に分けて総当たり等
- **注意点**: 同日複数大会でエントリーが混在する問題
- **改善案**:
  - グループ分け機能
  - 大会ごとのエントリー分離

### 🟢 緊急度：低（年末までに）

#### 5. 年間チャンピオンバッジ機能
- **実装内容**:
  - 12/31に年間成績を集計
  - 1位：金メダル、2位：銀メダル、3位：銅メダル
  - 実績ページに年度表示（例：2025年チャンピオン）
- **現状**: 未実装

#### 6. 年明けレーティングリセット
- **要望**: 1/1に全員のレーティングを1200にリセット
- **目的**: 年度ごとに同条件でスタート
- **実装**: 自動リセット機能

### 📊 その他（時間があるとき）

#### 7. スプレッドシートDB整理
- **問題**:
  - 無駄に複製されたシートが多数存在
  - 1行目のヘッダーと内容がずれている箇所あり
- **対応**:
  - 使用/未使用シートの整理
  - カラム定義の統一
  - 正確な仕様をdocs/000に記録

---

## 🐛 既知の問題・バグ

### 修正済み（最近）
- ✅ 試合編集時のレーティング二重計算
- ✅ PWAでキーボードが画面を隠す問題
- ✅ 完了試合編集時の重複作成

### 未解決・要調査
1. **大規模大会でのパフォーマンス**
   - 100人以上でGoogle Sheets APIレート制限の可能性
   - 対策: キャッシュ層追加検討

2. **オフライン時の挙動**
   - PWAキャッシュが不完全
   - Service Worker改善必要

---

## 💡 技術的改善案

### パフォーマンス最適化
1. **Redis/Upstash KV導入**
   - 現在未使用のUpstash KVを活用
   - APIレスポンスキャッシュ
   - リアルタイムデータの一時保存

2. **データベース移行検討**
   - Supabase移行でリアルタイム性向上
   - コスト: 月額$25〜
   - 移行スクリプト要作成

### コード品質向上
1. **テストカバレッジ向上**
   - 現在: テストなし
   - 目標: 主要機能80%カバレッジ
   - Jest + React Testing Library導入

2. **型安全性強化**
   - API レスポンスの型定義
   - Zodによるランタイム検証

---

## 📊 運用状況

### 利用実績
- **稼働期間**: 2025年7月〜現在
- **開催大会数**: 10+ 回
- **登録プレイヤー**: 50+ 人
- **累計試合数**: 500+ 試合

### コスト
- **現在**: 月額 $0（無料枠内）
- **商用移行時**: 月額約3,000円
  - Vercel Pro: $20/月
  - ドメイン: 約$10/年

### パフォーマンス指標
- **API応答時間**: 平均200-500ms
- **ページロード**: 1-2秒
- **Google Sheets API使用量**: 月10万リクエスト以下

---

## 🔧 メンテナンス情報

### 定期作業
- **週次**: ログ確認、エラー監視
- **月次**: Google Sheets容量確認、バックアップ
- **年次**: 依存関係更新、セキュリティ監査

### 緊急時対応手順
1. **システムダウン時**
   ```bash
   # Vercel状態確認
   vercel logs --follow

   # キャッシュクリア
   ./purge_cache.sh

   # 手動デプロイ
   vercel --prod
   ```

2. **データ破損時**
   ```bash
   # Google Sheetsから手動復旧
   node scripts/backup-restore.js
   ```

3. **API制限時**
   - Google Cloud Consoleで制限確認
   - 必要に応じて有料プラン検討

---

## 📚 重要ドキュメント参照

### 必読ドキュメント
- `CLAUDE.md` - プロジェクト固有の開発ルール
- `SHEETS_SETUP.md` - Google Sheets構造詳細
- `docs/036-tournament-lifecycle-overview.md` - 大会ライフサイクル
- `docs/050-pwa-notification-system.md` - PWA実装詳細

### API仕様
- `/api/tournaments.js` - 大会管理
- `/api/matches.js` - 試合管理
- `/api/players.js` - プレイヤー管理
- `/api/rankings.js` - ランキング

---

## 🤝 連絡先・サポート

### 開発者
- **名前**: 菊池健司（ちーけん）
- **GitHub**: @kenjireds08
- **対応可能**: 機能追加、バグ修正、保守運用

### クライアント
- **蕨迫様（わらびさこ）**: BUNGU SQUAD運営
- **定例MTG**: 月1回程度
- **連絡方法**: メール、Discord

---

## ⚠️ 注意事項

1. **Upstash KV削除予告**
   - 現在未使用のため削除されても影響なし
   - 将来的にキャッシュ層として再利用可能

2. **Google Sheets制限**
   - 無料枠: 500万セル、月間APIリクエスト上限あり
   - 大規模化時はDB移行検討必要

3. **商用利用時**
   - Vercel Pro契約必須（規約違反回避）
   - SSL証明書自動更新確認

---

最終更新: 2025-09-13 13:59
更新者: Claude Code (ちーけんさん依頼)